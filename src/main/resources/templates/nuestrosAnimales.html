<!DOCTYPE html>
<html lang="es" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/layout.html}">
<head>
	<title>Nuestros Animales</title>
	<link rel="stylesheet" th:href="@{/css/general.css}"/>
</head>
<body>

<section layout:fragment="content">
	<div class="row m-5 pt-3">
		<div class="col-7 contenedorIzquierdo">
			<h2>Nuestros animales disponibles:</h2>
			<p>Adoptar un animal de nuestro refugio no solo significa darle una segunda oportunidad a un ser que ha sufrido
				el abandono,
				sino también ganar un compañero fiel que llenará tu hogar de amor y alegría. Cada uno de nuestros animales
				ha sido cuidado con esmero,
				recibiendo la atención veterinaria necesaria y mucho cariño mientras espera una familia que le brinde el
				hogar que merece.
			</p>
		</div>

		<div class="col-5 align-self-center contenedorDerecho">
			<h3>&#x1F6E1;&#xFE0F; Sé responsable</h3>
			<h3>&#129309; Compromiso y Paciencia</h3>
			<h3>&#128054; Agradecimiento y apoyo </h3>
		</div>

	</div>

	<!-- Modal único -->
	<div class="modal fade" id="exampleModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h1 class="modal-title fs-5" id="modalNombre">Nombre</h1>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
				</div>
				<div class="modal-body">
					<div class="row mx-1">
						<img id="modalImagen" src="" alt="Foto del animal" class="img-fluid">
					</div>
					<p class="textoModal m-1 p-3" id="modalDescripcion">
					</p>
					<p class="textoModal mx-3">
						<strong>Peso:</strong> <span id="modalPeso"></span><br>
						<strong>Edad:</strong> <span id="modalEdad"></span><br>
						<strong>Género:</strong> <span id="modalGenero"></span>
					</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
					<div class="row d-flex justify-content-center flex-nowrap mx-3">
						<a id="modalBotonApadrina" class="botonesCardAnimal btn card_btn">
							Apadrina
						</a>
						<a id="modalBotonAdopta" class="botonesCardAnimal btn card_btn">
							Adopta
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>

	<main>
		<div class="row m-1 filtrosTop justify-content-center">
			<button type="button" id="grid-active-btn">
				<i class="fas fa-th"></i>
			</button>
			<button type="button" id="details-active-btn">
				<i class="fas fa-list-ul"></i>
			</button>
		</div>
		<div class="row m-3">
			<div class="col-12 contenedorCards justify-content-center">
				<div class="card cardAnimal" th:each="animal : ${animales}">
					<div class="card_image">
						<img class="imgCardAnimal" th:src="${animal.rutaImg1}" alt="foto de perro disponible para adoptar"></div>
					<div class="card_content d-flex justify-content-center card_contentAnimal">
						<h2 class="card_title card_titleAnimal" th:utext="${animal.nombre}"></h2>
						<p class="card_tex card_textAnimal">
							<span th:text="${animal.peso}"></span>,
							<span th:text="${animal.edad}"></span>,
							<span th:if="${animal.genero == false}">Hembra</span>
							<span th:unless="${animal.genero == false}">Macho</span></p>
						<div class="row d-flex justify-content-center flex-nowrap">
							<a th:if="${animal.adoptado == false && animal.caracterSocial == true}"
							   th:href="@{/adopta/{id}(id=${animal.id})}"
							   class="botonesCardAnimal btn card_btn">Adopta</a>

							<button th:if="${animal.adoptado == false}"
									th:class="'btn card_btn ' + (${animal.caracterSocial} == true? 'botonesCardAnimal' : 'botonesCardAnimalApadrina')">
								Apadrina
							</button>
						</div>
						<div class="row d-flex justify-content-center flex-nowrap hiddenCardContent">
							<button type="button" class="botonesCardAnimal botonesCardLeerMas btn card_btn arrow"
									data-bs-toggle="modal" data-bs-target="#exampleModal"
									th:attr="data-id=${animal.id},
										data-nombre=${animal.nombre},
										data-imagen=${animal.rutaImg1},
										data-descripcion=${animal.descripcion},
										data-peso=${animal.peso},
										data-edad=${animal.edad},
										data-genero=${animal.genero},
										data-adoptado=${animal.adoptado},
									    data-caracter=${animal.caracterSocial}"> Leer Más
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const modalNombre = document.getElementById('modalNombre');
			const modalDescripcion = document.getElementById('modalDescripcion');
			const modalPeso = document.getElementById('modalPeso');
			const modalEdad = document.getElementById('modalEdad');
			const modalGenero = document.getElementById('modalGenero');
			const modalImagen = document.getElementById('modalImagen');
			const modalBotonAdopta = document.getElementById('modalBotonAdopta');
			const modalBotonApadrina = document.getElementById('modalBotonApadrina');

			const leerMasBtns = document.querySelectorAll('.botonesCardLeerMas');

			leerMasBtns.forEach(btn => {
				btn.addEventListener('click', () => {
					const nombre = btn.getAttribute('data-nombre');
					const descripcion = btn.getAttribute('data-descripcion');
					const peso = btn.getAttribute('data-peso');
					const edad = btn.getAttribute('data-edad');
					const genero = btn.getAttribute('data-genero') === 'true' ? 'Macho' : 'Hembra';
					const imagen = btn.getAttribute('data-imagen');
					const id = btn.getAttribute('data-id');
					const adoptado = btn.getAttribute('data-adoptado') === 'true';
					const caracter = btn.getAttribute('data-caracter') === 'true';

					// Set info en el modal
					modalNombre.textContent = nombre;
					modalDescripcion.textContent = descripcion;
					modalPeso.textContent = peso;
					modalEdad.textContent = edad;
					modalGenero.textContent = genero;
					modalImagen.setAttribute('src', imagen);
					modalBotonAdopta.setAttribute('href', `/adopta/${id}`);

					// Mostrar/ocultar botones según lógica
					if (!adoptado && caracter) {
						modalBotonAdopta.style.display = 'inline-block';
						modalBotonApadrina.style.display = 'inline-block';
						modalBotonApadrina.className = 'botonesCardAnimal btn card_btn';
					} else if (!adoptado && !caracter) {
						modalBotonAdopta.style.display = 'none';
						modalBotonApadrina.style.display = 'inline-block';
						modalBotonApadrina.className = 'botonesCardAnimalApadrina btn card_btn';
					} else {
						modalBotonAdopta.style.display = 'none';
						modalBotonApadrina.style.display = 'none';
					}
				});
			});
		});
	</script>
</section>
</body>
</html>