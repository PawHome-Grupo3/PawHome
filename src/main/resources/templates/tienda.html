<!DOCTYPE html>
<html lang="es" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout.html}" xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:text="#{page.index.title}"></title>
  <link rel="stylesheet" th:href="@{/css/general.css}"/>
</head>
<body style="background-color: #f4faf8;">

<section layout:fragment="content">
  <div th:replace="~{fragments/navTienda :: navTiendaFragment}"></div>

  <!-- Tarjetas -->
  <section th:each="categoria : ${categorias}" class="section-padding pb-0" th:id="${categoriasNavDto.get(categoria.getId()-1).getNombre()}">
    <div class="container">
      <div class="row contCardsTienda justify-content-center">

        <div class="col-lg-12 col-12 text-center">
          <h2 class="w-auto tituloTienda m-0" th:utext="${categoria.getNombre()}"></h2>
        </div>

        <div th:each="producto : ${categoria.getProductos()}" class="col-lg-4 col-md-6 col-12 mb-4 mb-lg-0" >
          <div class="custom-block-wrap">
            <img th:src="${producto.getRutaImagen1()}" class="custom-block-image img-fluid" alt="">

            <div class="custom-block">
              <div class="custom-block-body py-0">
                <h5 class="mb-3" style="color:#5bc1ac; font-weight: 600;" th:utext="${producto.getNombre()}"></h5>

                <p style="color:#717275; font-weight: 300; font-size: 16px;" th:utext="${producto.getDescripcion()}"></p>
              </div>

              <div class="d-flex justify-content-center flex-row w-100 flex-nowrap align-items-stretch gap-1">
                <a th:href="@{/tienda/producto/{id}(id=${producto.getId()})}" class="custom-btn btn btnHazteVoluntario w-100 align-content-center">Más Info</a>
                <a th:if="${producto.getTallas()?.size() == 1 && producto.getTallas().getFirst().getTallaje().equalsIgnoreCase('unica')}" href="/tienda" class="custom-btn btn btnHazteVoluntario w-100 align-content-center">Añadir</a>
                <div th:unless="${producto.getTallas().getFirst().getTallaje().equalsIgnoreCase('unica')}" class="dropdown w-100 align-content-center justify-content-center">
                  <button class="custom-btn btn btnHazteVoluntario w-100 align-content-center"
                          type="button" id="tallaDropdown" data-bs-toggle="dropdown" aria-expanded="false">Escoge Talla</button>
                  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="tallaDropdown">
                    <li th:each="talla : ${producto.getTallas()}" th:if="${talla.getStock() > 0}"><a class="dropdown-item text-center" href="#" data-bs-toggle="modal" data-bs-target="#" th:utext="${talla.getTallaje()}"></a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>
</section>
</body>
</html>