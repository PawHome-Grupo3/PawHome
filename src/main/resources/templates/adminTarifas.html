<!DOCTYPE html>
<html lang="es" xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layoutAdmin.html}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Animales</title>
</head>
<body>

<section layout:fragment="content">

    <div class="container pt-5">
        <div class="row justify-content-lg-end mt-5 p-10">
            <h1>Te damos la bienvenida al panel administrativo</h1>
            <!-- Formulario Crear/Editar -->
            <form id="crudForm" class="row g-3 mb-4">
                <input type="hidden" id="editIndex">
                <div class="col-md-4">
                    <input type="text" id="nombre" class="form-control" placeholder="Nombre" required>
                </div>
                <div class="col-md-4">
                    <input type="email" id="email" class="form-control" placeholder="Email" required>
                </div>
                <div class="col-md-4">
                    <button type="submit" class="btn btn-primary w-100">Guardar</button>
                </div>
            </form>

            <!-- Tabla de Registros -->
            <table class="table table-striped table-bordered">
                <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Nombre</th>
                    <th>Chip</th>
                    <th>Peso</th>
                    <th>Edad</th>
                    <th>Caracter social</th>
                    <th>Descripción</th>
                    <th>Género</th>
                    <th>Origen</th>
                    <th>Estado de adopción</th>
                    <th>Fecha de llegada</th>
                    <th>Posibilidad de pasearlo</th>
                </tr>
                </thead>
                <tbody id="crudTableBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        let registros = [];

        function renderTable() {
            const tbody = document.getElementById('crudTableBody');
            tbody.innerHTML = '';
            registros.forEach((reg, idx) => {
                tbody.innerHTML += `
      <tr>
        <td>${idx + 1}</td>
        <td>${reg.nombre}</td>
        <td>${reg.email}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" onclick="editarRegistro(${idx})">Editar</button>
          <button class="btn btn-sm btn-danger" onclick="eliminarRegistro(${idx})">Eliminar</button>
        </td>
      </tr>
    `;
            });
        }

        document.getElementById('crudForm').onsubmit = function (e) {
            e.preventDefault();
            const nombre = document.getElementById('nombre').value.trim();
            const email = document.getElementById('email').value.trim();
            const editIndex = document.getElementById('editIndex').value;

            if (editIndex === '') {
                registros.push({nombre, email});
            } else {
                registros[editIndex] = {nombre, email};
                document.getElementById('editIndex').value = '';
            }

            this.reset();
            renderTable();
        };

        function editarRegistro(idx) {
            document.getElementById('nombre').value = registros[idx].nombre;
            document.getElementById('email').value = registros[idx].email;
            document.getElementById('editIndex').value = idx;
        }

        function eliminarRegistro(idx) {
            if (confirm('¿Seguro que deseas eliminar este registro?')) {
                registros.splice(idx, 1);
                renderTable();
            }
        }

        renderTable();
    </script>
</section>
</body>
</html>
